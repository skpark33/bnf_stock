# momentum_trend.py 사용 가이드

## 📌 개요
모멘텀 + 추세 전략 기반 종목 선정 및 백테스팅 도구

---

## 🔧 사용법

### 기본 실행
```bash
# 백테스팅 (기본 최적값 사용)
python momentum_trend.py --from 20250101 --to 20251014 --backtest --silent

# 디버그 모드
python momentum_trend.py --from 20250101 --to 20251014 --backtest --debug

# 손익/타임아웃 커스터마이징
python momentum_trend.py --from 20250101 --to 20251014 --backtest \
  --loss-cut 15 --profit-cut 25 --low_period 40
```

### 주요 옵션
| 옵션 | 설명 | 기본값 |
|------|------|--------|
| `--from` | 시작일 (YYYYMMDD) | 필수 |
| `--to` | 종료일 (YYYYMMDD) | 필수 |
| `--backtest` | 백테스팅 모드 | - |
| `--loss-cut` | 손절 퍼센트 | 16.0 |
| `--profit-cut` | 익절 퍼센트 | 22.0 |
| `--low_period` | 타임아웃 기간 (일) | 35 |
| `--silent` | 간략 출력 모드 | - |
| `--debug` | 조건별 통과율 표시 | - |

---

## 📊 종목 선정 전략

### 5단계 필터링
1. **정배열 필터**: 현재가 > 5일선 > 20일선 > 60일선 > 120일선
2. **신고가 근접**: 20일 최고가 대비 98~102% 범위 + 전일 대비 상승
3. **거래량 폭발**: 평균 거래량의 2배 이상
4. **RSI 골든크로스**: RSI > RSI Signal (9일선)
5. **MACD > 0**: 상승 추세 확인

---

## 🎯 최적 설정 (백테스팅 검증 완료)

### 손절/익절/타임아웃
```
손절: -16% (기본값)
익절: +22% (기본값)
타임아웃: 35일 (기본값)

리스크-리워드 비율: 1.38
```

### 백테스팅 성과 (2025년 1월~10월)
```
총 종목: 98개
청산 완료: 90개 (91.8%)

손절: 18개 (20.0%)
익절: 32개 (35.6%)
타임아웃: 40개 (44.4%)

승률: 60.0%
평균 수익률: +6.01%
최대 수익률: +33.69%
```

---

## 💡 핵심 인사이트

1. **손절을 느슨하게** (-16%) 하면 일시적 조정 후 반등 포착 가능
2. **익절 +22%**가 +21%보다 평균 수익률 0.16%p 높음
3. **35일 타임아웃**이 최적 (너무 짧으면 익절 기회 박탈, 너무 길면 수익률 저하)
4. **손절률 20%** = 10번 중 8번 성공

---

## 📁 출력 파일

```
data/json/kospi200/[year]/result/momentum_trend_[from]_[to].csv
```

CSV 파일에는 선정 종목 정보와 백테스팅 통계가 포함됩니다.

---

## ⚠️ 주의사항

- `--from`, `--to` 필수 (백테스팅 시)
- 데이터 파일이 없으면 `get_data.py`로 데이터 수집 필요
- 최소 150일 이상의 과거 데이터 필요 (120일 MA 계산)

---

**버전**: v3.2  
**최종 업데이트**: 2025-11-15

